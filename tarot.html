<!DOCTYPE 21h 28.10.25 html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tr·∫£i B√†i Tarot - ƒê√¥ng T√¢y Vibes</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style>
        :root {
            --color-primary: #5A189A; /* T√≠m ƒë·∫≠m */
            --color-accent: #FFC300; /* V√†ng */
            --color-text: #333;
            --color-background: #f4f7f9;
            /* TƒÉng k√≠ch th∆∞·ªõc ch·ªØ m·∫∑c ƒë·ªãnh */
            --base-font-size: 1.05rem; 
            --heading-font-size: 1.8rem;
            --menu-font-size: 1.1rem; /* K√≠ch th∆∞·ªõc menu trung b√¨nh */
            --font-weight-bold: 700;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--color-background);
            color: var(--color-text);
            padding: 20px;
            text-align: center;
            font-size: var(--base-font-size);
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: #ffffff;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: var(--color-primary);
            margin-bottom: 25px;
            font-size: 2.5rem; /* TƒÉng size H1 */
            font-weight: var(--font-weight-bold);
            border-bottom: 3px solid var(--color-accent);
            display: inline-block;
            padding-bottom: 5px;
        }

        /* --- Menu Ch√≠nh --- */
        .main-menu-bar {
            margin-bottom: 30px;
            display: flex;
            justify-content: center;
            gap: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #ddd;
        }
        
        .main-menu-bar a {
            color: var(--color-primary);
            font-size: var(--menu-font-size);
            font-weight: var(--font-weight-bold);
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 5px;
            transition: background-color 0.2s;
        }
        
        .main-menu-bar a:hover {
            background-color: #eee;
            color: var(--color-accent);
        }
        /* --- End Menu Ch√≠nh --- */


        .controls {
            margin-bottom: 30px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .controls h3 {
            color: var(--color-primary);
            margin-bottom: 10px;
            font-size: var(--heading-font-size);
            font-weight: var(--font-weight-bold);
        }

        .card-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px; /* TƒÉng kho·∫£ng c√°ch gi·ªØa c√°c n√∫t */
        }

        .card-buttons button {
            background-color: var(--color-primary);
            color: white;
            border: none;
            padding: 15px 25px; /* TƒÉng padding n√∫t */
            border-radius: 10px;
            cursor: pointer;
            font-size: var(--base-font-size);
            font-weight: var(--font-weight-bold);
            transition: all 0.2s;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        
        /* Hi·ªáu ·ª©ng khi ƒëang r√∫t b√†i */
        .card-buttons button:disabled {
            background-color: #A083C5;
            cursor: not-allowed;
            transform: none;
        }

        .card-buttons button:hover:not(:disabled) {
            background-color: #7B3EAB;
            transform: translateY(-2px);
        }

        .card-buttons button:active:not(:disabled) {
            transform: scale(0.98);
        }

        .result-area {
            margin-top: 30px;
            border-top: 2px dashed var(--color-primary);
            padding-top: 20px;
            text-align: left;
        }

        #spread-title {
            color: var(--color-primary);
            font-size: 1.8rem;
            margin-bottom: 20px;
            font-weight: var(--font-weight-bold);
            text-align: center;
        }
        
        #drawing-status {
            color: var(--color-primary);
            font-size: 1.2rem;
            margin-bottom: 20px;
            font-weight: 600;
        }

        #cards-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 30px; /* TƒÉng kho·∫£ng c√°ch gi·ªØa c√°c l√° b√†i */
            margin-bottom: 20px;
            min-height: 250px; /* Gi·ªØ ch·ªó ƒë·ªÉ tr√°nh layout b·ªã nh·∫£y */
        }

        .card-display {
            width: 160px; /* TƒÉng chi·ªÅu r·ªông */
            min-height: 220px; /* TƒÉng chi·ªÅu cao */
            background-color: #fff;
            border: 3px solid var(--color-accent); /* TƒÉng border */
            border-radius: 12px;
            padding: 12px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
            transition: transform 0.3s, opacity 0.5s;
            font-size: var(--base-font-size);
            opacity: 0; /* M·∫∑c ƒë·ªãnh ·∫©n ƒë·ªÉ t·∫°o hi·ªáu ·ª©ng */
        }
        
        .card-placeholder {
             /* L√° b√†i √∫p - V·∫´n hi·ªÉn th·ªã ƒë·ªÉ gi·ªØ v·ªã tr√≠ */
            width: 160px; 
            min-height: 220px;
            background-color: var(--color-primary); 
            border: 3px solid #ccc; 
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
            opacity: 1; 
        }

        .card-display.revealed {
            opacity: 1; /* Hi·ªÉn th·ªã khi ƒë∆∞·ª£c r√∫t */
        }

        .card-display strong {
            display: block;
            font-size: 1.2rem; /* TƒÉng size t√™n v·ªã tr√≠ */
            color: var(--color-primary);
            margin-bottom: 8px;
            font-weight: var(--font-weight-bold);
        }

        .card-display span {
            display: block;
            font-size: 1.0rem; /* TƒÉng size t√™n b√†i */
            font-weight: 600; /* L√†m ƒë·∫≠m ch·ªØ */
            color: var(--color-text);
        }
        
        .card-display:hover {
            transform: translateY(-5px);
        }

        .card-info {
            font-style: italic;
            color: #666;
            margin-bottom: 20px;
            text-align: center;
            font-size: var(--base-font-size);
        }
        
        /* AI Selection */
        .ai-selection {
            margin-top: 40px;
            padding: 25px;
            border: 2px dashed var(--color-primary);
            border-radius: 12px;
            background-color: #f8f0ff;
            text-align: center;
            display: none; /* M·∫∑c ƒë·ªãnh ·∫©n cho ƒë·∫øn khi r√∫t b√†i xong */
        }

        .ai-selection p {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .ai-selection button {
            background-color: var(--color-accent);
            color: var(--color-primary);
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: var(--font-weight-bold);
            margin: 0 10px;
            transition: background-color 0.2s;
            font-size: 1.0rem;
        }
        
        .ai-selection button:hover {
            background-color: #FFD740;
        }

        #copy-message {
            margin-top: 15px;
            color: green;
            font-weight: var(--font-weight-bold);
            font-size: 1.0rem;
        }

        .notes {
            margin-top: 40px;
            padding: 25px;
            background-color: #e6f7ff;
            border-left: 5px solid var(--color-primary);
            text-align: left;
            border-radius: 8px;
        }

        .notes p {
            margin-bottom: 10px;
            font-size: 0.95rem;
            color: #004d66;
        }
        
        .notes strong {
            color: var(--color-primary);
            font-weight: var(--font-weight-bold);
        }
        
        @media (max-width: 600px) {
            :root {
                --base-font-size: 1rem;
                --heading-font-size: 1.5rem;
                --menu-font-size: 1rem;
            }
            .container {
                padding: 15px;
            }
            .card-display, .card-placeholder {
                width: 100%;
                max-width: 140px;
                padding: 10px;
                min-height: 180px;
            }
            .card-display strong {
                font-size: 1.1rem;
            }
            .card-display span {
                font-size: 0.9rem;
            }
            .card-buttons button {
                padding: 10px 15px;
                font-size: 0.9rem;
            }
            .main-menu-bar {
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        
        <div class="main-menu-bar">
            <a href="https://chudich.github.io/IChing2.html"><i class="fas fa-home"></i> Trang Ch·ªß</a>
            <a href="#controls"><i class="fas fa-magic"></i> R√∫t B√†i Tarot</a>
        </div>

        <h1>üîÆ Tr·∫£i B√†i Tarot</h1>
        
        <div class="controls" id="controls">
            <h3>Ch·ªçn Ph∆∞∆°ng Ph√°p Tr·∫£i B√†i:</h3>
            <div class="card-buttons">
                <button id="btn-1" onclick="drawCards(1, 'Tr·∫£i B√†i NƒÉng L∆∞·ª£ng S·ª± Vi·ªác C·ª• Th·ªÉ')">1 L√°: S·ª± Vi·ªác</button>
                <button id="btn-7" onclick="drawCards(7, 'Tr·∫£i B√†i Tarot 1 Tu·∫ßn')">7 L√°: 1 Tu·∫ßn</button>
                <button id="btn-4" onclick="drawCards(4, 'Tr·∫£i B√†i Tarot 1 Th√°ng')">4 L√°: 1 Th√°ng</button>
                <button id="btn-6-3" onclick="drawCards(6, 'Tr·∫£i B√†i Tarot 3 Th√°ng')">6 L√°: 3 Th√°ng</button>
                <button id="btn-10" onclick="drawCards(10, 'Tr·∫£i B√†i Tarot 6 Th√°ng')">10 L√°: 6 Th√°ng</button>
                <button id="btn-12" onclick="drawCards(12, 'Tr·∫£i B√†i Tarot 1 NƒÉm')">12 L√°: 1 NƒÉm</button>
            </div>
        </div>

        <div id="result-area" class="result-area" style="display: none;">
            <div id="spread-title"></div>
            <div id="drawing-status" style="display: none;">ƒêang r√∫t l√° b√†i...</div>
            <div id="cards-container"></div>
            
            <div class="ai-selection" id="ai-selection">
                <p>K·∫øt qu·∫£ ƒë√£ ƒë∆∞·ª£c sao ch√©p v√†o b·ªô nh·ªõ t·∫°m. H√£y ch·ªçn AI ƒë·ªÉ gi·∫£i b√†i:</p>
                <button onclick="openAI('Gemini')">Gi·∫£i b·∫±ng Gemini</button>
                <button onclick="openAI('ChatGPT')">Gi·∫£i b·∫±ng ChatGPT</button>
                <div id="copy-message" style="display: none;">ƒê√£ sao ch√©p!</div>
            </div>
        </div>
        
        <div class="notes">
            <strong>Ch√∫ th√≠ch v·ªÅ Khung th·ªùi gian:</strong>
            <p>Tr·∫£i b√†i **1 Tu·∫ßn** bao g·ªìm t·ª´ Th·ª© Hai ƒë·∫øn Ch·ªß Nh·∫≠t ti·∫øp theo.</p>
            <p>Tr·∫£i b√†i **1 Th√°ng** bao g·ªìm t·ª´ Ng√†y 1 ƒë·∫øn cu·ªëi th√°ng hi·ªán t·∫°i.</p>
            <p>Tr·∫£i b√†i **3 Th√°ng** bao g·ªìm th√°ng hi·ªán t·∫°i v√† 2 th√°ng k·∫ø ti·∫øp.</p>
            <p>Tr·∫£i b√†i **6 Th√°ng** bao g·ªìm th√°ng hi·ªán t·∫°i v√† 5 th√°ng k·∫ø ti·∫øp.</p>
            <p>Tr·∫£i b√†i **1 NƒÉm** b·∫Øt ƒë·∫ßu t·ª´ Th√°ng 1 ƒë·∫øn Th√°ng 12 c√πng nƒÉm (b·∫•t k·ªÉ b·∫°n ƒëang ·ªü th√°ng n√†o).</p>
        </div>
    </div>

    <script>
        const MAJOR_ARCANA = [
            '0 - The Fool', 'I - The Magician', 'II - The High Priestess', 'III - The Empress', 
            'IV - The Emperor', 'V - The Hierophant', 'VI - The Lovers', 'VII - The Chariot', 
            'VIII - Strength', 'IX - The Hermit', 'X - Wheel of Fortune', 'XI - Justice', 
            'XII - The Hanged Man', 'XIII - Death', 'XIV - Temperance', 'XV - The Devil', 
            'XVI - The Tower', 'XVII - The Star', 'XVIII - The Moon', 'XIX - The Sun', 
            'XX - Judgement', 'XXI - The World'
        ];

        const MINOR_ARCANA_SUITS = ['Wands', 'Cups', 'Swords', 'Pentacles'];
        const CARD_RANKS = ['Ace', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'Page', 'Knight', 'Queen', 'King'];

        // L·∫•y t·∫•t c·∫£ n√∫t button r√∫t b√†i
        const allButtons = document.querySelectorAll('.card-buttons button');
        const cardsContainer = document.getElementById('cards-container');
        const resultArea = document.getElementById('result-area');
        const drawingStatus = document.getElementById('drawing-status');
        const aiSelection = document.getElementById('ai-selection');

        // T·∫°o b·ªô b√†i ƒë·∫ßy ƒë·ªß 78 l√°
        function createDeck() {
            let deck = [...MAJOR_ARCANA];
            for (const suit of MINOR_ARCANA_SUITS) {
                for (const rank of CARD_RANKS) {
                    deck.push(`${rank} of ${suit}`);
                }
            }
            return deck;
        }

        const FULL_DECK = createDeck();
        let currentSpreadName = '';
        let currentDrawnCards = [];
        const DRAW_DELAY = 3000; // 3 gi√¢y (3000ms)

        // H√†m ch√≠nh r√∫t b√†i v√† b·∫Øt ƒë·∫ßu hi·ªÉn th·ªã
        function drawCards(numCards, spreadName) {
            
            // 1. V√¥ hi·ªáu h√≥a n√∫t b·∫•m v√† thi·∫øt l·∫≠p tr·∫°ng th√°i
            allButtons.forEach(button => button.disabled = true);
            resultArea.style.display = 'block';
            aiSelection.style.display = 'none';
            cardsContainer.innerHTML = ''; // X√≥a k·∫øt qu·∫£ c≈©
            drawingStatus.style.display = 'block';
            document.getElementById('spread-title').textContent = spreadName.toUpperCase();
            document.getElementById('card-info').innerHTML = '';

            const deck = [...FULL_DECK];
            currentDrawnCards = [];
            currentSpreadName = spreadName;

            // X√°o b√†i (Fisher-Yates shuffle algorithm)
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }

            // R√∫t b√†i v√† t·∫°o m·∫£ng k·∫øt qu·∫£
            for (let i = 0; i < numCards; i++) {
                const cardIndex = Math.floor(Math.random() * deck.length);
                const card = deck.splice(cardIndex, 1)[0];
                const orientation = Math.random() < 0.5 ? 'U' : 'R';
                currentDrawnCards.push({
                    name: card,
                    orientation: orientation,
                    position: getPositionName(spreadName, i) // L∆∞u v·ªã tr√≠
                });
                
                // Th√™m Placeholder ngay l·∫≠p t·ª©c ƒë·ªÉ gi·ªØ ch·ªó
                const placeholderDiv = document.createElement('div');
                placeholderDiv.className = 'card-placeholder';
                placeholderDiv.innerHTML = `<i class="fas fa-hand-sparkles"></i>`;
                placeholderDiv.id = `card-idx-${i}`;
                cardsContainer.appendChild(placeholderDiv);
            }
            
            // 2. B·∫Øt ƒë·∫ßu hi·ªÉn th·ªã t·ª´ng l√° b√†i v·ªõi ƒë·ªô tr·ªÖ
            for (let i = 0; i < numCards; i++) {
                // ƒê·ªô tr·ªÖ l≈©y ti·∫øn: i=0 -> 3s, i=1 -> 6s, i=2 -> 9s, ...
                const delay = (i + 1) * DRAW_DELAY; 
                
                setTimeout(() => {
                    revealCard(i, numCards);
                }, delay);
            }
        }

        // H√†m hi·ªÉn th·ªã t·ª´ng l√° b√†i
        function revealCard(index, totalCards) {
            const cardData = currentDrawnCards[index];
            const placeholder = document.getElementById(`card-idx-${index}`);
            
            if (!cardData || !placeholder) return;

            drawingStatus.textContent = `ƒêang r√∫t l√° b√†i th·ª© ${index + 1} / ${totalCards}...`;

            const orientationText = cardData.orientation === 'U' ? 'Xu√¥i' : 'Ng∆∞·ª£c';
            
            const cardDiv = document.createElement('div');
            cardDiv.className = 'card-display revealed';
            cardDiv.innerHTML = `
                <strong>${cardData.position}</strong>
                <span>${cardData.name}</span>
                <span>(${orientationText})</span>
            `;
            
            // Thay th·∫ø Placeholder b·∫±ng l√° b√†i ƒë√£ r√∫t
            cardsContainer.replaceChild(cardDiv, placeholder);

            // Ki·ªÉm tra n·∫øu ƒë√¢y l√† l√° b√†i cu·ªëi c√πng
            if (index === totalCards - 1) {
                drawingStatus.style.display = 'none';
                displayFinalResults();
                copyToClipboard();
                allButtons.forEach(button => button.disabled = false); // K√≠ch ho·∫°t l·∫°i n√∫t
            }
        }
        
        // H√†m hi·ªÉn th·ªã k·∫øt qu·∫£ cu·ªëi c√πng (th√¥ng tin v·ªã tr√≠)
        function displayFinalResults() {
             const info = document.getElementById('card-info');
             const cardInfos = currentDrawnCards.map(card => card.position);
             info.innerHTML = `**C√°c v·ªã tr√≠ ƒë√£ r√∫t:** ${cardInfos.join(', ')}`;
             aiSelection.style.display = 'block';
        }

        // H√†m ƒë·∫∑t t√™n v·ªã tr√≠ cho c√°c ki·ªÉu tr·∫£i b√†i
        function getPositionName(spreadName, index) {
            const date = new Date();
            switch (spreadName) {
                case 'Tr·∫£i B√†i NƒÉng L∆∞·ª£ng S·ª± Vi·ªác C·ª• Th·ªÉ':
                    return 'NƒÉng L∆∞·ª£ng Ch√≠nh';
                case 'Tr·∫£i B√†i Tarot 1 Tu·∫ßn':
                    const days = ['Th·ª© Hai', 'Th·ª© Ba', 'Th·ª© T∆∞', 'Th·ª© NƒÉm', 'Th·ª© S√°u', 'Th·ª© B·∫£y', 'Ch·ªß Nh·∫≠t'];
                    return days[index];
                case 'Tr·∫£i B√†i Tarot 1 Th√°ng':
                    const weeks = ['Tu·∫ßn 1', 'Tu·∫ßn 2', 'Tu·∫ßn 3', 'Tu·∫ßn 4'];
                    return weeks[index];
                case 'Tr·∫£i B√†i Tarot 3 Th√°ng':
                    const currentMonth3 = date.getMonth();
                    const months3 = Array.from({ length: 3 }, (_, i) => 
                        new Date(new Date().setMonth(currentMonth3 + i)).toLocaleString('vi-VN', { month: 'long' })
                    );
                    const positions3 = [
                        `${months3[0]} (Hi·ªán t·∫°i)`, `${months3[1]}`, `${months3[2]}`, 
                        'Th√°ch th·ª©c', 'C∆° h·ªôi', 'K·∫øt qu·∫£ t·ªïng quan'
                    ];
                    return positions3[index] || `V·ªã tr√≠ ${index + 1}`;
                case 'Tr·∫£i B√†i Tarot 6 Th√°ng':
                    const currentMonth6 = date.getMonth();
                    const months6 = Array.from({ length: 6 }, (_, i) => 
                        new Date(new Date().setMonth(currentMonth6 + i)).toLocaleString('vi-VN', { month: 'long' })
                    );
                    const positions6 = [
                        `${months6[0]}`, `${months6[1]}`, `${months6[2]}`, `${months6[3]}`, `${months6[4]}`, `${months6[5]}`, 
                        'Th√°ch th·ª©c', 'C∆° h·ªôi', 'K·∫øt qu·∫£ (6 th√°ng)', 'B√†i h·ªçc'
                    ];
                    return positions6[index] || `V·ªã tr√≠ ${index + 1}`;
                case 'Tr·∫£i B√†i Tarot 1 NƒÉm':
                    const months12 = ['Th√°ng 1', 'Th√°ng 2', 'Th√°ng 3', 'Th√°ng 4', 'Th√°ng 5', 'Th√°ng 6', 
                                      'Th√°ng 7', 'Th√°ng 8', 'Th√°ng 9', 'Th√°ng 10', 'Th√°ng 11', 'Th√°ng 12'];
                    return months12[index];
                default:
                    return `V·ªã tr√≠ ${index + 1}`;
            }
        }

        // H√†m sao ch√©p k·∫øt qu·∫£ v√†o b·ªô nh·ªõ t·∫°m
        function copyToClipboard() {
            if (currentDrawnCards.length === 0) return;

            const spreadDetails = currentDrawnCards.map(card => {
                const orientationText = card.orientation === 'U' ? 'Xu√¥i' : 'Ng∆∞·ª£c';
                return `${card.position}: ${card.name} (${orientationText})`;
            }).join('\n');

            const copyText = `${currentSpreadName}:\n${spreadDetails}\n\n[Y√™u c·∫ßu gi·∫£i b√†i chi ti·∫øt d·ª±a tr√™n c√°c l√° b√†i ƒë√£ r√∫t n√†y.]`;

            navigator.clipboard.writeText(copyText).then(() => {
                const copyMessage = document.getElementById('copy-message');
                copyMessage.style.display = 'block';
                setTimeout(() => {
                    copyMessage.style.display = 'none';
                }, 3000);
            }).catch(err => {
                console.error('Kh√¥ng th·ªÉ sao ch√©p vƒÉn b·∫£n: ', err);
                alert('T·ª± ƒë·ªông sao ch√©p th·∫•t b·∫°i. Vui l√≤ng sao ch√©p th·ªß c√¥ng:\n' + copyText);
            });
        }

        // H√†m m·ªü AI Chat
        function openAI(aiName) {
            let url = '';
            
            if (aiName === 'Gemini') {
                url = 'https://gemini.google.com/app';
            } else if (aiName === 'ChatGPT') {
                url = 'https://chat.openai.com/';
            }
            
            window.open(url, '_blank');
        }
    </script>
</body>
</html>
